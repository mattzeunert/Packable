<app-dialog-header
  [header]="step>1? '' : 'New Traveler' "
  (close)="onClose()"
  [showReturn]="step>1"
  (return)="backStep()"></app-dialog-header>





<ng-container *ngIf="step === 1">
  <mat-dialog-content>
    <div @transitionTrigger>
      <profile-edit-form
        [(profile)]="profile"
        (validChange)="profileEditFormValidation($event)"
        #profileForm>
      </profile-edit-form>
      <div class="my-3 text-center" *ngIf="allProfiles && allProfiles.length > 0">
         <button
         mat-raised-button
           [disabled]="!profileFormValid"
           (click)="onChooseMethod('copy')">
           <mat-icon outlined>fasce</mat-icon>
           <span>Copy Existing Traveler</span>
         </button>
         <p>or create blank Traveler...</p>
       </div>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions>
    <dialog-confirm-button>
      <button
        mat-fab
        class="mx-1"
        activeColor="action"
        (click)="onNextStep()"
        [disabled]="!profileFormValid">
        <mat-icon>check</mat-icon>
      </button>
    </dialog-confirm-button>
  </mat-dialog-actions>
</ng-container>
<ng-container
  *ngIf="step === 2"
  [ngSwitch]="method">
  <ng-container *ngSwitchCase="'copy'">
    <mat-dialog-content>
      <div @transitionTrigger>
        <div style="position: sticky;top:0;z-index:1; background: white;">
          <div class="text-center">
            <profile-icon
              [profile]="profile"
              [showName]="true"
              width="65px">
            </profile-icon>
          </div>
          <p class="text-center">Select a Traveler to copy:</p>
        </div>
        <div>
          <div class="profile-card-container">
          <ng-container *ngFor="let profile of allProfiles">
                <div
                  class="profile-card-flex"
                  [class.selected]="selectedProfile === profile.id"
                  (click)="selectedProfile = profile.id">
                  <div class="profile-card-icon">
                    <profile-icon
                      [profile]="profile"
                      [showName]="true"
                      width="80px">
                    </profile-icon>
                  </div>
                </div>
              </ng-container>
            </div>
            <div class="my-3 text-center" *ngIf="storeSelector.isLibraryStore === false">
              <p>or...</p>
              <button
              mat-raised-button
                [disabled]="!profileFormValid"
                (click)="onChooseMethod('template')">
                <mat-icon outlined>assignment_ind</mat-icon>
                <span>Use Templates</span>
              </button>
            </div>
        </div>
      </div>
    </mat-dialog-content>
    <mat-dialog-actions>
        <dialog-confirm-button>
          <button
            mat-fab
            class="mx-1"
            activeColor="action"
            (click)="chooseCopy()"
            [disabled]="!selectedProfile">
            <mat-icon>check</mat-icon>
          </button>
        </dialog-confirm-button>
      </mat-dialog-actions>
  </ng-container>






  <ng-container *ngSwitchCase="'template'">
    <mat-dialog-content>
      <div @transitionTrigger>
        <div style="position: sticky;top:0;z-index:1; background: white;">
          <div class="text-center">
            <profile-icon
              [profile]="profile"
              [showName]="true"
              width="65px">
            </profile-icon>
          </div>
          <p class="text-center">Select a Traveler Template:</p>
        </div>
        <div class="dialog-row scrollable">
          <div class="profile-card-container">
            <ng-container *ngFor="let profile of templateProfiles">
              <div
                class="profile-card-flex"
                [class.selected]="selectedProfile === profile.id"
                (click)="selectedProfile = profile.id">
                <div class="profile-card-icon">
                  <profile-icon
                    [profile]="profile"
                    [fullFrame]="true"
                    color="white"
                    [showName]="false"
                    width="80px">
                  </profile-icon>
                </div>
                <div class="profile-card-name">{{profile.name}}</div>
              </div>
            </ng-container>
          </div>
          <div class="my-3 text-center" *ngIf="allProfiles && allProfiles.length > 0">
             <p>or...</p>
            <button
            mat-raised-button
              [disabled]="!profileFormValid"
              (click)="onChooseMethod('copy')">
              <mat-icon outlined>face</mat-icon>
              <span>Copy Existing Traveler</span>
            </button>
          </div>
        </div>
      </div>
    </mat-dialog-content>
    <mat-dialog-actions>
      <dialog-confirm-button>
        <button
          mat-fab
          class="mx-1"
          activeColor="action"
          (click)="chooseTemplate()"
          [disabled]="!selectedProfile">
          <mat-icon>check</mat-icon>
        </button>
      </dialog-confirm-button>
    </mat-dialog-actions>
  </ng-container>
  <!-- <ng-container *ngSwitchCase="'new'">
      <mat-dialog-content>
          <div @transitionTrigger>
            <div>
              <div class="text-center">
                <profile-icon
                  [profile]="profile"
                  [showName]="true"
                  width="65px">
                </profile-icon>
              </div>
              <p>
                Select the Essential Collections you wish to pack on EVERY trip. Collections and Packables with weather rules will only be added once conditions are met.
              </p>
            </div>
            <div style="position: sticky;top:0;z-index:1; background: white;">
              <search-field
                [(value)]="searchString"
                placeholder="Search Collections">
              </search-field>
            </div>
            <div>
              <collection-selector
                [collections]="collections"
                [(selected)]="selectedCollections"
                [filterInput]="searchString">
              </collection-selector>
            </div>
          </div>
        </mat-dialog-content>
        <mat-dialog-actions>
          <dialog-confirm-button>
            <button
              mat-fab
              class="mx-1"
              activeColor="action"
              (click)="onComplete()"
              [disabled]="selectedCollections.length===0">
              <mat-icon>check</mat-icon>
            </button>
          </dialog-confirm-button>
        </mat-dialog-actions>
      
  </ng-container> -->
</ng-container>
